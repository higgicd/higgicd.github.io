{
  "hash": "1e838e534b5a18677628a725d2d173aa",
  "result": {
    "markdown": "---\ntitle: \"King Street Transit Priority Corridor Travel Times\"\ndate: \"2022-08-27\"\ncategories: [code, analysis]\nimage: \"kstpc_small.jpg\"\n---\n\n\nRobert Arku (PhD Student at the University of Toronto) and I are exploring the association between transit accessibility and real estate through an analysis of the King Street Transit Priority Corridor project in Toronto. As part of this, we are estimating the change in streetcar travel times along the corridor using a database of disaggregate streetcar travel times from the TTC and City of Toronto. To coincide with migrating my site over to a Quarto webpage, this seemed like a good topic through which to explore computational blog posts made using RStudio.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![King Street Pilot Project - Planters & furniture near Charlotte St.](./kstpc_banner.jpg){#fig-banner fig-align='center' width=100%}\n:::\n:::\n\n\n*Photo by *[TheTrolleyPole](https://upload.wikimedia.org/wikipedia/commons/3/31/King_Street_Pilot_Project_-_Planters_%26_furniture_near_Charlotte_St.jpg) *via Wikimedia Commons*\n\n## King Street Transit Priority Corridor\n\nThe Transit Priority corridor launched as a pilot project on November 12, 2017, with the primary objective of improving transit service along a 2.6km stretch of King Street between Bathurst and Jarvis Streets in downtown Toronto (@fig-kstpc_corridor).\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![King Street Pilot Corridor](./kstpc_corridor.jpg){#fig-kstpc_corridor fig-align='center' width=100%}\n:::\n:::\n\n\n*Image courtesy of the City of Toronto*\n\nTransit priority was achieved by restricting through-movements and left turns for private vehicles, removing on-street parking, and giving priority transit vehicles (@fig-kstpc_design). Streetscape improvements such as seating, patios, public art, bicycle parking, and parkettes made the corridor more pedestrian- and cyclist-friendly.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Sample Urban Design Plan for the King Street Pilot Corridor Project](./kstpc_design.jpg){#fig-kstpc_design fig-align='center' width=100%}\n:::\n:::\n\n\n*Image courtesy of the City of Toronto*\n\nAs a pilot project, the City of Toronto collected a wealth of data related to transit vehicle performance, traffic, pedestrian and cyclist volumes, business performance, and stakeholder feedback along the corridor and posted regular updates through a [project dashboard](https://www.toronto.ca/city-government/planning-development/planning-studies-initiatives/king-street-pilot/data-reports-background-materials/). One of these datasets is [streetcar travel times](https://open.toronto.ca/dataset/king-street-pilot-disaggregate-headway-and-travel-time/) collected using the TTC's Communication and Information System (CIS) that tracks transit vehicle movements throughout the city.\n\nWith regards to primary objective of increasing travel speeds and the reliability of streetcar services along the corridor, previous analyses conducted by the City and others (e.g. [1](https://stevemunro.ca/2018/03/29/a-detailed-review-of-king-street-travel-times/); [2](http://sausy.ca/2017/11/king-street-transit-pilot-project/)) have examined CIS and GPS data and concluded that the implementation of the priority corridor generally resulted in decreases in travel times and improvements to service reliability. We will follow their lead to calculate the change in travel times across the pre-pilot and pilot period phases from the CIS data.\n\n## Load TTC CIS Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(purrr)\nlibrary(gt)\nlibrary(ggdist)\nlibrary(opendatatoronto)\n```\n:::\n\n\nThe first step is to use the {opendatatoronto} package to fetch the resources associated with the disaggregate streetcar headway and travel time data package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npackage_resources <- list_package_resources(\"e74ba0ba-07c8-4a18-bac9-57bd2b9698c1\")\npackage_resources %>% glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 3\nColumns: 4\n$ name          <chr> \"ttc-king-st-pilot-disaggregate-weekday-travel-time-2017…\n$ id            <chr> \"dbe81d22-d5a4-49db-a454-aad69e1e0140\", \"5df19475-bc6c-4…\n$ format        <chr> \"XLSX\", \"XLSX\", \"CSV\"\n$ last_modified <date> 2019-07-23, 2019-07-23, 2019-07-23\n```\n:::\n:::\n\n\nThere are three data files within this package: travel times and headways in `.xlsx` format and a summary `.csv` file. Let's get the travel time resource using its resource ID and take a glimpse:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresource_id <- package_resources %>%\n  filter(name == \"ttc-king-st-pilot-disaggregate-weekday-travel-time-2017-2018-xlsx\") %>%\n  pull(id)\n\nresource <- get_resource(resource_id)\nresource %>% glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nList of 3\n $ Sheet1: tibble [342,759 × 14] (S3: tbl_df/tbl/data.frame)\n  ..$ TripID       : num [1:342759] 16053362 16053365 16053215 16052346 16052017 ...\n  ..$ RouteNumber  : chr [1:342759] \"304\" \"304\" \"504\" \"504\" ...\n  ..$ VehicleNumber: chr [1:342759] \"4179\" \"4179\" \"4157\" \"4076\" ...\n  ..$ RunNumber    : num [1:342759] 15 15 1 15 35 30 19 31 7 21 ...\n  ..$ Direction    : chr [1:342759] \"EAST\" \"WEST\" \"WEST\" \"EAST\" ...\n  ..$ FromStopAbbr : chr [1:342759] \"BKIN\" \"KGJV\" \"KGJV\" \"BKIN\" ...\n  ..$ FromStopName : chr [1:342759] \"KING ST WEST AT BATHURST ST\" \"KING ST EAST AT JARVIS ST\" \"KING ST EAST AT JARVIS ST\" \"KING ST WEST AT BATHURST ST\" ...\n  ..$ ToStopAbbr   : chr [1:342759] \"KGJV\" \"BKIN\" \"BKIN\" \"KGJV\" ...\n  ..$ ToStopName   : chr [1:342759] \"KING ST EAST AT JARVIS ST\" \"KING ST WEST AT BATHURST ST\" \"KING ST WEST AT BATHURST ST\" \"KING ST EAST AT JARVIS ST\" ...\n  ..$ TimePeriod   : chr [1:342759] \"0-EARLY (3am-7am)\" \"0-EARLY (3am-7am)\" \"0-EARLY (3am-7am)\" \"0-EARLY (3am-7am)\" ...\n  ..$ ObservedDate : chr [1:342759] \"2017-01-03\" \"2017-01-03\" \"2017-01-03\" \"2017-01-03\" ...\n  ..$ TripTime     : POSIXct[1:342759], format: \"2017-01-03 03:43:00\" \"2017-01-03 04:42:40\" ...\n  ..$ RunningTime  : num [1:342759] 14.33 10 9.67 12.67 12.33 ...\n  ..$ Speed        : num [1:342759] 10.8 15.2 15.5 11.7 12.2 ...\n $ Sheet2: tibble [0 × 0] (S3: tbl_df/tbl/data.frame)\n Named list()\n $ Sheet3: tibble [0 × 0] (S3: tbl_df/tbl/data.frame)\n Named list()\n```\n:::\n:::\n\n\nWhile the {opendatatoronto} package downloads the data in an R-friendly format, because the original streetcar travel times file was a `.xlsx`, it looks like the returned data resource is actually a list of three tibbles structured around Excel sheets (e.g. Sheet1, Sheet2, Sheet3). The streetcar travel times data is in `Sheet1`, so next we will use `pluck` from the {purrr} package to extract the trip times:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrip_times <- resource %>% pluck(\"Sheet1\") \n```\n:::\n\n\n## Prepare Data\n\nThe CIS data contains travel times and speeds for eastbound and westbound streetcar trips across the Pilot corridor along King Street between stops at Bathurst and Jarvis Streets. The trips are grouped into major service time periods (e.g. AM Peak, PM Peak, etc.) and the data also includes general information such as the streetcar route number and vehicle and trip IDs. To prepare the travel times for further analysis, we will do some data operations such as converting the `ObservedDate` from a `character` type to a proper `date`, getting the day of the week, and some factor operations including creating a variable corresponding to the baseline and pilot time periods:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrip_times <- trip_times %>%\n  mutate(\n    # make into proper datetime\n    ObservedDate = as_date(ObservedDate),\n    \n    # get day of week to make sure no weekends\n    day_name = wday(ObservedDate, label = TRUE),\n    \n    TimePeriod = str_sub(TimePeriod, start = 3),\n    TimePeriod = as.factor(TimePeriod),\n    TimePeriod = fct_relevel(TimePeriod, \n                             c(\"EARLY (3am-7am)\",\n                               \"AM (7am-10am)\",\n                               \"MID (10am-4pm)\",\n                               \"PM (4pm-7pm)\",\n                               \"EVENING (7pm-10pm)\",\n                               \"LATE (10pm-)\")),\n    \n    # classify baseline and pilot time periods\n    phase = case_when(ObservedDate > as_date(\"2017-11-12\") ~ \"pilot\",\n                     TRUE ~ \"baseline\"),\n    phase = as.factor(phase),\n    phase = fct_relevel(phase, c(\"baseline\", \"pilot\")),\n    \n    # recode direction\n    Direction = fct_recode(Direction, eastbound = \"EAST\", westbound = \"WEST\"))\n```\n:::\n\n\nThe final step is to filter the trip times data down to trips that occurred between the start of September 2017 and the end of January 2018. This corresponds to about 2.5 months of data on either side of the pilot implementation on November 12, 2017.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfiltered_trip_times <- trip_times %>%\n  filter(between(x = ObservedDate, \n                 left = as_date(\"2017-09-04\"), \n                 right = as_date(\"2018-01-31\")), \n         day_name != \"Sat\") \n```\n:::\n\n\n## Results\n\n@fig-travel_times_plot shows the final plot of travel times before and after the introduction of the pilot. It certainly looks as though the implementation of the pilot reduced average travel times and decreased travel time variability within this time window.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(filtered_trip_times, aes(x = ObservedDate, y = RunningTime)) + \n  geom_point(position = position_jitter(seed = 1, width = 0.2), \n             size = 0.2, col = \"grey80\", alpha = 0.5) +\n  geom_smooth(se = FALSE, method = \"gam\", \n              formula = y ~ s(log(x)), aes(colour = phase)) +\n  facet_grid(rows = vars(Direction)) + \n  geom_vline(aes(xintercept = lubridate::as_date(\"2017-11-12\")), \n             linetype = \"dashed\", size = 0.25) +\n  ylim(c(0, 80)) +\n  ylab(\"minutes\") +\n  #ggtitle(\"Priority Corridor Travel Times\") +\n  scale_colour_manual(values = c(\"#33638DFF\", \"#3CBB75FF\")) +\n  theme_minimal() +\n  theme(axis.title.x=element_blank(),\n        legend.position=\"bottom\")\n```\n\n::: {.cell-output-display}\n![Priority Corridor Travel Times: Baseline and Pilot](index_files/figure-html/fig-travel_times_plot-1.png){#fig-travel_times_plot width=672}\n:::\n:::\n\n\nThis is generally confirmed by calculating the mean travel times in the eastbound and westbound directions across phases (@tbl-travel_times). Here we see a decrease in travel times across every time period other than the 3am-7am Early service period, with the biggest difference in the PM peak.\n\n\n::: {#tbl-travel_times .cell tbl-cap='Priority Corridor Average Travel Times: Baseline and Pilot (minutes)'}\n\n```{.r .cell-code}\nfiltered_trip_times %>%\n  group_by(phase, TimePeriod, Direction) %>%\n  summarize(mean_tt = mean(RunningTime)) %>%\n  \n  # double pivot to get travel times by direction and phase\n  pivot_wider(names_from = Direction, values_from = mean_tt) %>%\n  pivot_wider(names_from = phase, values_from = c(\"eastbound\", \"westbound\")) %>%\n  ungroup() %>%\n  \n  # calculate travel time differences and relocate eastbound result for table\n  mutate(eastbound_difference = eastbound_pilot - eastbound_baseline,\n         westbound_difference = westbound_pilot - westbound_baseline) %>%\n  relocate(eastbound_difference, .after = eastbound_pilot) %>%\n  \n  # create a gt table\n  gt(rowname_col = \"TimePeriod\") %>%\n  \n  # create table grouping based on direction - split at delimiter e.g. eastbound_pilot\n  tab_spanner_delim(delim = \"_\") %>%\n  \n  # format table numbers\n  fmt_number(contains(c(\"baseline\", \"pilot\", \"difference\")), decimals = 1)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"tshexhpwcx\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#tshexhpwcx .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#tshexhpwcx .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tshexhpwcx .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#tshexhpwcx .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#tshexhpwcx .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tshexhpwcx .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tshexhpwcx .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#tshexhpwcx .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#tshexhpwcx .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#tshexhpwcx .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#tshexhpwcx .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#tshexhpwcx .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#tshexhpwcx .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#tshexhpwcx .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#tshexhpwcx .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#tshexhpwcx .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#tshexhpwcx .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tshexhpwcx .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#tshexhpwcx .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#tshexhpwcx .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tshexhpwcx .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#tshexhpwcx .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#tshexhpwcx .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tshexhpwcx .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tshexhpwcx .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#tshexhpwcx .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#tshexhpwcx .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tshexhpwcx .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tshexhpwcx .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tshexhpwcx .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tshexhpwcx .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tshexhpwcx .gt_left {\n  text-align: left;\n}\n\n#tshexhpwcx .gt_center {\n  text-align: center;\n}\n\n#tshexhpwcx .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#tshexhpwcx .gt_font_normal {\n  font-weight: normal;\n}\n\n#tshexhpwcx .gt_font_bold {\n  font-weight: bold;\n}\n\n#tshexhpwcx .gt_font_italic {\n  font-style: italic;\n}\n\n#tshexhpwcx .gt_super {\n  font-size: 65%;\n}\n\n#tshexhpwcx .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#tshexhpwcx .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#tshexhpwcx .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#tshexhpwcx .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#tshexhpwcx .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#tshexhpwcx .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#tshexhpwcx .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\"></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\">\n        <span class=\"gt_column_spanner\">eastbound</span>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\">\n        <span class=\"gt_column_spanner\">westbound</span>\n      </th>\n    </tr>\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">baseline</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">pilot</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">difference</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">baseline</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">pilot</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\">difference</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><th scope=\"row\" class=\"gt_row gt_left gt_stub\">EARLY (3am-7am)</th>\n<td class=\"gt_row gt_right\">12.9</td>\n<td class=\"gt_row gt_right\">13.0</td>\n<td class=\"gt_row gt_right\">0.1</td>\n<td class=\"gt_row gt_right\">12.4</td>\n<td class=\"gt_row gt_right\">12.4</td>\n<td class=\"gt_row gt_right\">0.1</td></tr>\n    <tr><th scope=\"row\" class=\"gt_row gt_left gt_stub\">AM (7am-10am)</th>\n<td class=\"gt_row gt_right\">16.3</td>\n<td class=\"gt_row gt_right\">15.2</td>\n<td class=\"gt_row gt_right\">−1.1</td>\n<td class=\"gt_row gt_right\">15.8</td>\n<td class=\"gt_row gt_right\">14.5</td>\n<td class=\"gt_row gt_right\">−1.3</td></tr>\n    <tr><th scope=\"row\" class=\"gt_row gt_left gt_stub\">MID (10am-4pm)</th>\n<td class=\"gt_row gt_right\">17.8</td>\n<td class=\"gt_row gt_right\">14.5</td>\n<td class=\"gt_row gt_right\">−3.2</td>\n<td class=\"gt_row gt_right\">17.2</td>\n<td class=\"gt_row gt_right\">13.8</td>\n<td class=\"gt_row gt_right\">−3.4</td></tr>\n    <tr><th scope=\"row\" class=\"gt_row gt_left gt_stub\">PM (4pm-7pm)</th>\n<td class=\"gt_row gt_right\">21.3</td>\n<td class=\"gt_row gt_right\">17.0</td>\n<td class=\"gt_row gt_right\">−4.2</td>\n<td class=\"gt_row gt_right\">21.2</td>\n<td class=\"gt_row gt_right\">16.5</td>\n<td class=\"gt_row gt_right\">−4.7</td></tr>\n    <tr><th scope=\"row\" class=\"gt_row gt_left gt_stub\">EVENING (7pm-10pm)</th>\n<td class=\"gt_row gt_right\">17.3</td>\n<td class=\"gt_row gt_right\">13.8</td>\n<td class=\"gt_row gt_right\">−3.5</td>\n<td class=\"gt_row gt_right\">18.1</td>\n<td class=\"gt_row gt_right\">13.9</td>\n<td class=\"gt_row gt_right\">−4.2</td></tr>\n    <tr><th scope=\"row\" class=\"gt_row gt_left gt_stub\">LATE (10pm-)</th>\n<td class=\"gt_row gt_right\">15.8</td>\n<td class=\"gt_row gt_right\">12.8</td>\n<td class=\"gt_row gt_right\">−3.0</td>\n<td class=\"gt_row gt_right\">15.4</td>\n<td class=\"gt_row gt_right\">12.1</td>\n<td class=\"gt_row gt_right\">−3.2</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nWhile some special events in the fall of 2017 impact the travel times in this baseline period, such as the Toronto International Film Festival, doing the same analysis to compare the baseline period with data from one year later (September to end of October 2018) shows some stability in the reductions in average travel times over the service periods (@fig-travel_time_comparison_plot).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfiltered_trip_times_late_2018 <- trip_times %>%\n  filter(between(x = ObservedDate, \n                 left = as_date(\"2018-09-01\"), \n                 right = as_date(\"2018-10-31\")), \n         day_name != \"Sat\") %>%\n  mutate(phase = \"late 2018\") %>%\n  bind_rows(filtered_trip_times) %>%\n  mutate(phase = as.factor(phase),\n         phase = fct_relevel(phase,\n                             \"baseline\", \"pilot\", \"late 2018\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(filtered_trip_times_late_2018, \n       aes(y = RunningTime, x = TimePeriod, fill = phase)) +\n  stat_slab(side = \"both\", \n            scale = 0.5,\n            show.legend = TRUE,\n            position = position_dodge(width = .8),\n            aes(fill_ramp = stat(level)),\n            .width = c(.50, .75, .95, 1)) +\n  stat_summary(fun = \"mean\",\n               geom = \"crossbar\", \n               width = 0.5,\n               lwd = 0.1,\n               position = position_dodge(width = .8),\n               show.legend = F)  +\n  scale_colour_manual(values = c(\"#33638DFF\", \"#3CBB75FF\", \"#FDE725FF\"), aesthetics = \"fill\")+\n  guides(fill_ramp = \"none\") +\n  ylab(\"minutes\") +\n  ylim(10, 30) +\n  facet_grid(rows = vars(as.factor(Direction))) +\n  theme_minimal() +\n  theme(axis.title.x = element_blank(),\n        axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),\n        legend.position=\"top\")\n```\n\n::: {.cell-output-display}\n![Priority Corridor Travel Times: Baseline, Pilot, and Late 2018](index_files/figure-html/fig-travel_time_comparison_plot-1.png){#fig-travel_time_comparison_plot width=672}\n:::\n:::\n\n\nThe results from this analysis are feeding into our ongoing work looking into how changes in travel times contribute to changes in accessibility and real estate prices - more on this soon!\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}